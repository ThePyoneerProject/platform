{% extends "base.html" %}
{% load static %}

{% block content %}
    <div class="flex flex-col md:flex-row 2xl:mt-20">
        {# Hero #}
        <div class="min-w-[50%] hero-section md:h-auto flex flex-col justify-center items-center text-center p-6 prose">
            <h1 class="text-6xl text-gray-300 mb-5 2xl:mb-0 font-mono tracking-wider">
                Become a 10x engineer with
                <img src="{% static 'img/python-logo.png' %}" alt="Python Logo" class="inline-block w-16 h-16 my-0 mt-3 sm:mt-0 ml-2">
            </h1>
            <p class="text-2xl text-gray-300 mb-5 2xl:mb-3">
                Want to dominate the tech world? ðŸš€
            </p>
            <p class="text-2xl text-gray-300 mt-0 mb-3 2xl:mb-6">
                Become a <span class="text-yellow-500 font-bold">full-stack engineer</span> with me.
                Unleash your potential to craft <span class="text-blue-500 font-bold">insane web applications</span>
                in just 4 months.<br>
            </p>
            <button id="hell-yea-button" class="btn bg-gray-800 btn-lg group hover:border-gray-600 mt-6 2xl:mt-3">
                <span class="group-hover:hidden">Are You All In? <span id="thinking-emoji">ðŸ¤”</span></span>
                <span class="hidden group-hover:block">Hell yea!!! <span id="fire-emoji">ðŸ”¥</span></span>
            </button>
        </div>

        {# Interactive Chat box #}
        <div id="interactive-container" class="flex flex-col justify-center items-start w-full px-6 2xl:px-12 py-6"
             _="on intersection
              transition #intro-message-1's opacity to 1
              then transition #intro-message-2's opacity to 1
              then transition #chat-box-inputs's opacity to 1
              then transition #excuses-container's opacity to 1"
        >

            <div id="chat-box-outer-container" class="border border-gray-600 bg-base-100 relative rounded-l-box rounded-tr-box max-md:rounded-r-box w-full p-8 2xl:max-h-72 overflow-y-hidden">
                <div id="chat-box-inner-container" class="flex min-h-[6rem] 2xl:max-h-[15rem] min-w-[18rem] max-w-4xl flex-wrap items-center gap-4 w-full overflow-y-scroll"
                     _="init set my scrollTop to 0">

                    {# Interactive Chat Box #}
                    <div id="chat-box" class="w-full"
                         hx-get="{% url 'receive_gigachad_message' %}"
                         hx-target="#gigachad-message-to-replace"
                         hx-trigger="requestMessage"
                         hx-vals="js:{'message_content': $userMessage}"
                         hx-swap="outerHTML scroll:#chat-box-inner-container:bottom">

                        {# Chat messages #}
                        <div id="intro-message-1" class="chat chat-start" style="opacity:0">
                            <div class="chat-image avatar">
                                <div class="w-10 rounded-full">
                                    <img src="{% static 'img/giga-chad.jpeg' %}"  alt="Giga Chad"/>
                                </div>
                            </div>
                            <div class="chat-bubble chat-bubble-warning">
                                Hey, I'm the Script Ogre. I'm a full-stack engineer and I'm here to help you become a 10x engineer.
                            </div>
                        </div>

                        <div id="intro-message-2" class="chat chat-end" style="opacity:0">
                            <div class="chat-image avatar">
                                <div class="w-10 rounded-full">
                                    <img src="{% static 'img/soyjack.png' %}"  alt="Soy Jack"/>
                                </div>
                            </div>
                            <div class="chat-bubble">
                                I'm not ready to become a 10x engineer... I barely know how to code. Besides...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {# Chat box input #}
            <div id="chat-box-inputs" class="flex justify-center 2xl:justify-end w-full mt-3" style="opacity:0">
                <button class="btn bg-base-100 me-1"
                        hx-post="{% url 'send_user_message' %}"
                        hx-vals="js:{message_content: $userMessage}"
                        hx-trigger="sendUserMessage"
                        hx-target="#chat-box"
                        hx-swap="beforeend scroll:#chat-box-inner-container:bottom"
                        _="on click
                            {# Set the global userMessage #}
                            set $userMessage to 'I dont have enough time'
                            {# To add the new chat bubble of the user #}
                            then trigger sendUserMessage
                            {# To make sure #gigachad-message-to-replace exists before triggering requestMessage #}
                            then wait for htmx:afterSettle from body
                            {# To request the response to userMessage from GigaChad (OpenAI call in the backend) #}
                            then send requestMessage to #chat-box
                            then decrement #excuses's excusesNumber
                            then
                            if #excuses's excusesNumber == 0
                                put 'ðŸ“¸ ðŸ¤¨ No excuses left' into #excuses
                            else
                                put `Excuses ` + it + `/3` into #excuses
                            end
                            {# Disable this button >#}
                            then add @disabled='true' to me">
                    No Time
                </button>
                <button class="btn bg-base-100 me-1"
                        hx-post="{% url 'send_user_message' %}"
                        hx-vals="js:{message_content: $userMessage}"
                        hx-trigger="sendUserMessage"
                        hx-target="#chat-box"
                        hx-swap="beforeend scroll:#chat-box-inner-container:bottom"
                        _="on click
                            {# Set the global userMessage #}
                            set $userMessage to 'I dont have any talent'
                            {# To add the new chat bubble of the user #}
                            then trigger sendUserMessage
                            {# To make sure #gigachad-message-to-replace exists before triggering requestMessage #}
                            then wait for htmx:afterSettle from body
                            {# To request the response to userMessage from GigaChad (OpenAI call in the backend) #}
                            then send requestMessage to #chat-box
                            then decrement #excuses's excusesNumber
                            then
                            if #excuses's excusesNumber == 0
                                put 'ðŸ“¸ ðŸ¤¨ No excuses left' into #excuses
                            else
                                put `Excuses ` + it + `/3` into #excuses
                            end
                            {# Disable this button >#}
                            then add @disabled='true' to me">
                    No Talent
                </button>
                <button class="btn bg-base-100"
                        hx-post="{% url 'send_user_message' %}"
                        hx-vals="js:{message_content: $userMessage}"
                        hx-trigger="sendUserMessage"
                        hx-target="#chat-box"
                        hx-swap="beforeend scroll:#chat-box-inner-container:bottom"
                        _="on click
                            {# Set the global userMessage #}
                            set $userMessage to 'I dont have patience'
                            {# To add the new chat bubble of the user #}
                            then trigger sendUserMessage
                            {# To make sure #gigachad-message-to-replace exists before triggering requestMessage #}
                            then wait for htmx:afterSettle from body
                            {# To request the response to userMessage from GigaChad (OpenAI call in the backend) #}
                            then send requestMessage to #chat-box
                            then decrement #excuses's excusesNumber
                            then
                            if #excuses's excusesNumber == 0
                                put 'ðŸ“¸ ðŸ¤¨ No excuses left' into #excuses
                            else
                                put `Excuses ` + it + `/3` into #excuses
                            end
                            {# Disable this button >#}
                            then add @disabled='true' to me">
                    No Patience
                </button>
            </div>

            {# Excuses #}
            <div id="excuses-container" class="flex justify-center 2xl:justify-end w-full mt-3" style="opacity:0">
                <p id="excuses"
                   class="text-2xl text-gray-300"
                   _="init set my excusesNumber to 3">
                    Excuses 3/3
                </p>
            </div>
        </div>
    </div>
{% endblock %}
