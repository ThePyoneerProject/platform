{# user_macros.jinja #}

{% macro avatar(user) %}
    {#
    Return the avatar URL from the social account if it exists,
    otherwise return a default image.
    #}
    {% set default_avatar = static('img/avatar-default.webp') %}

    {% if user.is_authenticated %}
        {% set social_account = get_social_accounts(user)|first %}
        {% set avatar_url = social_account.get_avatar_url() if 'None' not in social_account.get_avatar_url() %}

        {% if social_account is defined and avatar_url is defined %}
            {{ avatar_url }}
        {% else %}
            {{ default_avatar }}
        {% endif %}
    {% else %}
        {{ default_avatar }}
    {% endif %}
{% endmacro %}
